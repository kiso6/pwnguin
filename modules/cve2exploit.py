#!/usr/bin/env python3

from pymetasploit3.msfrpc import MsfRpcClient
from pymetasploit3.msfconsole import MsfRpcConsole
import subprocess
import json
import time 
#process = Popen(["msfrpcd" , "-P",  "yourpassword"], stdout=PIPE, stderr=PIPE)
#stdout, stderr = process.communicate()

proc = subprocess.run("msfrpcd -P yourpassword",shell=True)
time.sleep(5)
if (proc):
    client = MsfRpcClient('yourpassword', ssl=True)

# Connect to `msfrpcd` 
def getexploit(cve_list, client):

    print("[i] Starting process to match service names to modules...")
    potential_module_matches = []
    for cve in cve_list:
        modules = client.modules.search("type:exploit cve:" + cve)
        if modules:
            print(cve + "\n")
            potential_module_matches = potential_module_matches + modules

    print(f"[+] Potential Relevant Modules:\n\n{potential_module_matches}\n\n")
    return potential_module_matches

getexploit(['CVE-2023-27855', 'CVE-2023-27853', 'CVE-2023-27852', 'CVE-2023-27847', 'CVE-2023-27844', 'CVE-2023-27843', 'CVE-2023-27842', 'CVE-2023-27812', 'CVE-2023-2781', 'CVE-2023-27779', 'CVE-2023-2776', 'CVE-2023-27757', 'CVE-2023-27748', 'CVE-2023-27742', 'CVE-2023-2774', 'CVE-2023-27720', 'CVE-2023-27719', 'CVE-2023-27718', 'CVE-2023-27667', 'CVE-2023-27650', 'CVE-2023-27648', 'CVE-2023-27638', 'CVE-2023-27637', 'CVE-2023-27603', 'CVE-2023-27602', 'CVE-2023-27570', 'CVE-2023-27569', 'CVE-2023-27507', 'CVE-2023-2750', 'CVE-2023-27479', 'CVE-2023-27397', 'CVE-2023-27394', 'CVE-2023-27388', 'CVE-2023-2738', 'CVE-2023-27350', 'CVE-2023-2733', 'CVE-2023-2732', 'CVE-2023-27286', 'CVE-2023-27284', 'CVE-2023-27250'],client)